%!TEX TS-program = xelatex
%!languagre = zh
\documentclass{ctexart}
%这是main文件，请不要修改也不要删除，直接在subfile中编写和编译即可。
\usepackage[v1]{subfiles}
\usepackage{forloop}
\usepackage{tikz}
\usepackage{tikz-cd}
\usepackage{graphicx}
\usepackage{fixdif}
\usepackage{titling}
\setlength{\droptitle}{-4em}
\usepackage{amsmath,amsthm,amscd,amsfonts,mathrsfs,amssymb,bm,mathtools}
%\usepackage{mathabx}
\usepackage{enumerate} %tablists中的tabenum环境可实现一行多个小题自动编号
% \usepackage{hyperref}
\usepackage{fancyhdr}
\pagestyle{empty}
\usepackage{geometry} %页边距
\geometry{left=3cm,right=3cm,top=1.2cm,bottom=1.8cm}
\usepackage{float}
\usepackage{caption}
\usepackage{subfig}
\newtheorem{theorem}{定理}
\newtheorem{lemma}{引理}
\newtheorem{definition}{定义}
\newtheorem{corollary}{推论}
\newtheorem{example}{例}
\newtheorem{remark}{注}
\newtheorem{proposition}{命题}
\renewcommand{\(}{\begin{math}\displaystyle}
\renewcommand{\)}{\end{math}}
\newcommand{\filename}{main}
\makeatletter
\def\sf@@sub@label#1{%
\@bsphack
\sf@oldlabel{#1}%
\ifhyperrefloaded
\begingroup
\edef\@currentlabstr{%
\expandafter\strip@prefix\meaning\@currentlabelname}%
\protected@write\@auxout{}{%
\string\newlabel{\expandafter\filename:sub@#1}{%
{\caption@lstfmt
{\@nameuse{p@sub\@captype}}%
{\@nameuse{thesub\@captype}}}%
{\caption@subreffmt
{\@nameuse{p@sub\@captype}}%
{\@nameuse{thesub\@captype}}%
{\the\value{\@captype}}%
{\the\value{sub\@captype}}}%
{\expandafter\strip@period\@currentlabelname\relax.\relax\@@@}%
{\@currentHref}%
{}}}%
\endgroup
\else
\protected@write\@auxout{}{%
\string\newlabel{\expandafter\filename:sub@#1}{%
{\caption@lstfmt
{\@nameuse{p@sub\@captype}}%
{\@nameuse{thesub\@captype}}}%
{\caption@subreffmt
{\@nameuse{p@sub\@captype}}%
{\@nameuse{thesub\@captype}}%
{\the\value{\@captype}}%
{\the\value{sub\@captype}}}}}%
\fi
\@esphack}
\def\sf@subref#1{\ref{\expandafter\filename:sub@#1}}
\def\sf@@subref#1{\pageref{\expandafter\filename:sub@#1}}
\makeatother
\AtBeginDocument{%
\let\abslabel\label
\let\absref\ref
\let\abseqref\eqref
\renewcommand{\ref}[1]{\absref{\expandafter\filename:#1}}
\renewcommand{\eqref}[1]{\abseqref{\expandafter\filename:#1}}
\renewcommand{\label}[1]{\abslabel{\expandafter\filename:#1}}
}
\let\oldsection\section
\renewcommand{\section}[1]{\oldsection*{#1}}
\let\oldsubsection\subsection
\renewcommand{\subsection}[1]{\oldsubsection*{#1}}
\newcounter{files}
\begin{document}
\forloop{files}{1}{\value{files}<28}{%
	\IfFileExists{subfile\thefiles.tex}{%
		\subfile{subfile\thefiles.tex}%
		\newpage%
	}{}%
}

\end{document}
